<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Lab Assignment 10c (optional) | GEOG 4046 Web GIS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/open-iconic/1.1.1/font/css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="/css/cayman.css">
    <link rel="stylesheet" href="/css/style.css">
  </head>
  <body>
    <section class="page-header">
      <div class="shadebox">
        <h1 class="project-name"><a href="/">GEOG 4046</a></h1>
        <h2 class="project-tagline">An Introduction to Web GIS</h2>
        <div class="text-center">
          <a href="/">Syllabus</a> |
          <a href="/assignments">Assignments</a> |
          <a href="/notes">Notes</a> |
          <a href="/schedule">Schedule and Due Dates</a>
        </div>
      </div>
    </section>
    <section class="main-menu">

    </section>

    <section class="main-content">
      <h1 class="text-center">Lab Assignment 10c (optional)</h1>
      <h2 class="text-center">WRLD.js 3D map library</h2>
      <p>Create a web map using wrld.js, a library based on Leaflet that creates a map with 3D buildings and terrain. Start with a basic map and add more features as you explore the <a href="https://www.wrld3d.com/wrld.js/latest/docs/examples/">wrld.js documentation</a>. <strong>Requires an account and API key from WRLD</strong>.</p>

<link href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" rel="stylesheet" />

<script src="https://cdn-webgl.wrld3d.com/wrldjs/dist/latest/wrld.js"></script>

<script src="../../assignment-resources/js/map4.js"></script>

<div id="map4" style="height:500px; margin-bottom: 15px"></div>
<div>
  Fly to: 
  <button id="lafayette-square">Lafayette Square</button>
  <button id="jackson-square">Jackson Square</button>
</div>
<h2 id="process">Process</h2>
<ol>
  <li>
    <p>Create a copy of the previous assignment’s folder and rename it to <code class="highlighter-rouge">map4</code>. Rename the previous <code class="highlighter-rouge">.js</code> file to <code class="highlighter-rouge">map4.js</code> and update the <code class="highlighter-rouge">script</code> tags in <code class="highlighter-rouge">index.html</code> to use the new <code class="highlighter-rouge">map4.js</code> and the wrld.js library at <code class="highlighter-rouge">https://cdn-webgl.wrld3d.com/wrldjs/dist/latest/wrld.js</code>.</p>
  </li>
  <li>
    <p>In the JavaScript file, delete the contents and start with a new line to create a map with wrld.js. It uses syntax similar to Leaflet’s, but here the <code class="highlighter-rouge">L.Wrld.map</code> method takes an API key as its second parameter.</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">renameThisMap</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">Wrld</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="s1">'map'</span><span class="p">,</span> <span class="s1">'Your_API_key_goes_here'</span><span class="p">)</span>
</code></pre></div>    </div>
    <p>Test the page in a browser; it should display a 3D map.</p>
  </li>
  <li>
    <p>In addition to taking an API key as the second argument, the <code class="highlighter-rouge">L.Wrld.map</code> method can take an optional third argument to change map settings, such as the starting position and zoom:</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">renameThisMap</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">Wrld</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="s1">'map'</span><span class="p">,</span> <span class="s1">'Your_API_key_goes_here'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">center</span><span class="p">:</span> <span class="p">[</span><span class="mf">29.95</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.07</span><span class="p">],</span>
  <span class="na">zoom</span><span class="p">:</span> <span class="mi">15</span>
<span class="p">})</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>The wrld.js library has methods to change the environment of the map:</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">renameThisMap</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">setWeather</span><span class="p">(</span><span class="nx">L</span><span class="p">.</span><span class="nx">Wrld</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">weather</span><span class="p">.</span><span class="nx">Rainy</span><span class="p">)</span>
<span class="nx">renameThisMap</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">setTime</span><span class="p">(</span><span class="nx">L</span><span class="p">.</span><span class="nx">Wrld</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">Day</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>GeoJSON data can be added the same way as a Leaflet map:</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">geojsonUrlString</span> <span class="o">=</span> <span class="s1">'https://opendata.arcgis.com/datasets/3273a5f8334d40838681ff0337eddb8c_0.geojson'</span>
<span class="nx">jQuery</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="nx">geojsonUrlString</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">L</span><span class="p">.</span><span class="nx">geoJSON</span><span class="p">(</span><span class="nx">data</span><span class="p">).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">renameThisMap</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div>    </div>
    <p>Note: If you choose your own layer, it should show features at a local level, such as zoomed into a city, to show the 3D basemap. A statewide or national layer isn’t ideal because the 3D buildings won’t be visible when zoomed out far.</p>
  </li>
  <li>
    <p>And as with a normal Leaflet map, we can pass a second argument to the <code class="highlighter-rouge">L.geoJSON</code> method. The argument is an object containing some properties to customize what happens with the GeoJSON layer, including adding popups on each feature. Change the arguments to include the onEachFeature property:</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">L</span><span class="p">.</span><span class="nx">geoJSON</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">onEachFeature</span><span class="p">:</span> <span class="nx">renameThisCreatePopupFunction</span>
<span class="p">}).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">renameThisMap</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Now write the function <code class="highlighter-rouge">renameThisCreatePopupFunction</code> used above as the function that will be run on each GeoJSON feature. This GeoJSON dataset contains public parks in New Orleans, with an attribute called <code class="highlighter-rouge">NAME</code>. Therefore, the name of the park can be shown in the popup by referencing <code class="highlighter-rouge">feature.properties.NAME</code>:</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">renameThisCreatePopupFunction</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">feature</span><span class="p">,</span> <span class="nx">layer</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">layer</span><span class="p">.</span><span class="nx">bindPopup</span><span class="p">(</span><span class="nx">feature</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">NAME</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>We can also create a function to fly us to a point of interest on the map when the user clicks a button. First, create the button using HTML in <code class="highlighter-rouge">index.html</code>, somewhere in the <code class="highlighter-rouge">body</code>:</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"jackson-square"</span><span class="nt">&gt;</span>Jackson Square<span class="nt">&lt;/button&gt;</span>
</code></pre></div>    </div>
    <p>Change the <code class="highlighter-rouge">id</code> and button text for your map.</p>
  </li>
  <li>
    <p>Now create the function:</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jQuery</span><span class="p">(</span><span class="s1">'#jackson-square'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">renameThisMap</span><span class="p">.</span><span class="nx">setView</span><span class="p">([</span><span class="mf">29.957</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.063</span><span class="p">],</span> <span class="mi">17</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">headingDegrees</span><span class="p">:</span> <span class="o">-</span><span class="mi">45</span><span class="p">,</span>
    <span class="na">animate</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">durationSeconds</span><span class="p">:</span> <span class="mi">3</span>
  <span class="p">})</span>
<span class="p">})</span>
</code></pre></div>    </div>
    <p>Change <code class="highlighter-rouge">#jackson-square</code> to match your <code class="highlighter-rouge">id</code> in the HTML. The number values can be adjusted to fit with your map. Repeat steps 8 and 9 to create bookmarks for other places.</p>
  </li>
</ol>

<h2 id="requirements">Requirements</h2>
<ol>
  <li>General best practices:<br />
  a. Scripts and styles in separate files<br />
  b. Your own page title<br />
  c. Proper indentation<br />
  d. No errors in the console</li>
  <li>A basemap</li>
  <li>Features displayed on the map from a GeoJSON web service. Features should be at a local level, such as a city, to show the 3D basemap.</li>
  <li>A popup on each GeoJSON feature.</li>
  <li>An attribute value from the GeoJSON data diplayed in the popup.</li>
  <li>Appropriate zoom and center</li>
  <li>Rename variables and functions to something descriptive</li>
</ol>

<h2 id="submit">Submit</h2>
<ol>
  <li>The URL to your map page: <code class="highlighter-rouge">https://yourname.github.io/wrld</code></li>
</ol>

    </section>
<footer class="site-footer">
  
</footer>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"></script>
</body>
</html>

